window.__require=function e(t,o,n){function c(i,a){if(!o[i]){if(!t[i]){var s=i.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+i+"'")}i=s}var p=o[i]={exports:{}};t[i][0].call(p.exports,function(e){return c(t[i][1][e]||e)},p,p.exports,e,t,o,n)}return o[i].exports}for(var r="function"==typeof __require&&__require,i=0;i<n.length;i++)c(n[i]);return c}({Board:[function(e,t,o){"use strict";cc._RF.push(t,"02f51Uge45OxasmUK5bgWZD","Board");var n,c=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var c,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(c=e[a])&&(i=(r<3?c(i):r>3?c(t,o,i):c(t,o))||i);return r>3&&i&&Object.defineProperty(t,o,i),i},i=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),c=0;for(t=0;t<o;t++)for(var r=arguments[t],i=0,a=r.length;i<a;i++,c++)n[c]=r[i];return n};Object.defineProperty(o,"__esModule",{value:!0}),o.chessplace=o.safePlace=void 0;var a=cc._decorator,s=a.ccclass,l=a.property,p=[],u=[],f=[],d=[],y=[],h=[],v=[];o.safePlace=v;var g=i(new Array(16)).fill(-1);o.chessplace=g;var m,b=[],_=0;(function(e){e[e.red=0]="red",e[e.green=1]="green",e[e.yello=2]="yello",e[e.blue=3]="blue"})(m||(m={}));var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t[0]=null,t[1]=null,t.l1=null,t.l2=null,t.players=null,t}return c(t,e),t.prototype.onLoad=function(){this.setboardposition(),v.push(1,9,14,22,27,35,40,48)},t.prototype.start=function(){},t.prototype.update=function(){},t.prototype.setboardposition=function(){for(var e=0;e<58;e++)p.push({x:0,y:0}),u.push({x:0,y:0}),f.push({x:0,y:0}),d.push({x:0,y:0}),y.push({x:0,y:0});for(e=0;e<16;e++)h.push({x:0,y:0});for(p[12].x=640/15*7,p[12].y=0,p[25].x=0,p[25].y=640/15*-7,p[38].x=640/15*-7,p[38].y=0,p[51].x=0,p[51].y=640/15*7,e=0;e<6;e++)p[e].x=640/15,p[e].y=640/15*(7-e),p[6+e].x=(2+e)*(640/15),p[6+e].y=640/15,p[13+e].x=640/15*(7-e),p[13+e].y=640/15*-1,p[19+e].x=640/15,p[19+e].y=640/15*(-2-e),p[26+e].x=640/15*-1,p[26+e].y=(-7+e)*(640/15),p[32+e].x=640/15*(-2-e),p[32+e].y=640/15*-1,p[39+e].x=640/15*(e-7),p[39+e].y=640/15,p[45+e].x=640/15*-1,p[45+e].y=(2+e)*(640/15);for(e=0;e<52;e++)u[e]=p[e],f[e]=p[(e+13)%52],d[e]=p[(e+26)%52],y[e]=p[(e+39)%52];for(e=0;e<6;e++)u[52+e].x=0,u[52+e].y=640/15*(6-e),f[52+e].x=640/15*(6-e),f[52+e].y=0,d[52+e].x=0,d[52+e].y=640/15*(e-6),y[52+e].x=640/15*-(6-e),y[52+e].y=0;for(e=0;e<4;e++)for(var t=0;t<4;t++)h[4*e+t].x=cc.find("player"+(e+1).toString()+"/"+(4*e+t).toString(),this.players).x,h[4*e+t].y=cc.find("player"+(e+1).toString()+"/"+(4*e+t).toString(),this.players).y},t.prototype.test=function(e,t,o){switch(e){case"Green":o.runAction(cc.moveTo(1,cc.v2(u[t].x,u[t].y)));break;case"Yellow":o.runAction(cc.moveTo(1,cc.v2(f[t].x,f[t].y)));break;case"Blue":o.runAction(cc.moveTo(1,cc.v2(d[t].x,d[t].y)));break;case"Red":o.runAction(cc.moveTo(1,cc.v2(y[t].x,y[t].y)))}},t.prototype.move=function(e,t,o,n){for(var c=0;c<_;++c)b[c].length&&b.length<=_&&(n.name!=b[c][0].name&&n.name!=b[c][1].name||(cc.tween(cc.find("Canvas/board/player"+Math.trunc(parseInt(b[c][0].name)/4+1).toString()+"/"+b[c][0].name)).to(1,{scale:1}).start(),cc.tween(cc.find("Canvas/board/player"+Math.trunc(parseInt(b[c][1].name)/4+1).toString()+"/"+b[c][1].name)).to(1,{scale:1}).start(),b[c].splice(0,2)));if(-1==o)n.runAction(cc.moveTo(1,cc.v2(h[4*e+t].x,h[4*e+t].y)));else if(o<=51)n.runAction(cc.moveTo(1,cc.v2(p[o].x,p[o].y)));else switch(e){case 0:n.runAction(cc.moveTo(1,cc.v2(u[o].x,u[o].y)));break;case 1:n.runAction(cc.moveTo(1,cc.v2(f[o].x,f[o].y)));break;case 2:n.runAction(cc.moveTo(1,cc.v2(d[o].x,d[o].y)));break;case 3:n.runAction(cc.moveTo(1,cc.v2(y[o].x,y[o].y)))}},t.prototype.changeMoveShape=function(e,t,o,n,c){if(-1!=o)if(o<=51){if(.5==n.scale||.5==c.scale)return;cc.tween(n).to(1,{position:cc.v3(p[o].x,p[o].y,0)}).call(function(){cc.tween(n).to(3,{scale:.5,position:cc.v3(n.x-8,n.y-8,0)},cc.easeBackIn()).start(),cc.tween(c).to(3,{scale:.5,position:cc.v3(c.x+8,c.y+8,0)},cc.easeBackIn()).start()}).start(),b[_]=[],b[_][0]=n,b[_][1]=c,_++}else{switch(e){case 0:n.runAction(cc.moveTo(1,cc.v2(u[o].x,u[o].y)));break;case 1:n.runAction(cc.moveTo(1,cc.v2(f[o].x,f[o].y)));break;case 2:n.runAction(cc.moveTo(1,cc.v2(d[o].x,d[o].y)));break;case 3:n.runAction(cc.moveTo(1,cc.v2(y[o].x,y[o].y)))}cc.tween(n).to(3,{scale:.5,position:cc.v3(n.x+8,n.y+8,0)}).start(),cc.tween(c).to(3,{scale:.5,position:cc.v3(n.x-8,n.y-8,0)}).start()}},r([l(cc.Button)],t.prototype,0,void 0),r([l(cc.Node)],t.prototype,1,void 0),r([l(cc.Label)],t.prototype,"l1",void 0),r([l(cc.Label)],t.prototype,"l2",void 0),r([l(cc.Node)],t.prototype,"players",void 0),r([s],t)}(cc.Component);o.default=S,cc._RF.pop()},{}],ClientTest:[function(e,t,o){"use strict";cc._RF.push(t,"61996oppfhD5pmsgegeePA0","ClientTest");var n,c=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var c,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(c=e[a])&&(i=(r<3?c(i):r>3?c(t,o,i):c(t,o))||i);return r>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./WebSocket"),a=e("./Board"),s=e("./analysis"),l=cc._decorator,p=l.ccclass,u=l.property,f="Throw",d=6,y=0,h="Board",v=e("./Board"),g=e("./Board"),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.players=null,t.canvas=null,t.turncolor=null,t.Status=null,t.Dice=null,t.ip=null,t.Analysis=null,t.Board=null,t.Analysisfunc=null,t}return c(t,e),t.prototype.start=function(){this.piecesenabled(!1)},t.prototype.connectsever=function(){var e=this;i.default.uri="ws://"+cc.find("ipbox",this.ip).getComponent(cc.EditBox).string;try{i.default.connect(function(){i.default.send(JSON.stringify({Method:"test"}),function(t){console.log(t),e.ip.setPosition(0,1e3),e.Analysisfunc.GetAItosever()})})}catch(t){console.log(t)}},t.prototype.playDiceAnimation=function(){var e=this;this.Dice.getComponent(cc.Animation).play("diceanimation"),this.schedule(function(){e.Dice.getComponent(cc.Sprite).spriteFrame=cc.find("dice"+d.toString(),e.Dice).getComponent(cc.Sprite).spriteFrame},1)},t.prototype.Throwtosever=function(){var e=this,t={Method:"Throw",PlayerIndex:0,PieceIndex:0};console.log("request:",t),i.default.send(JSON.stringify(t),function(t){console.log("response:",t),e.updateboard(t.GS)})},t.prototype.Movetosever=function(e){var t=this,o={Method:"Move",PlayerIndex:y,PieceIndex:e};console.log("request:",o),i.default.send(JSON.stringify(o),function(e){console.log("response:",e),t.updateboard(e.GS)})},t.prototype.NewGametosever=function(){var e=this,t={Method:"NewGame",PlayerIndex:0,PieceIndex:0};console.log("request:",t),i.default.send(JSON.stringify(t),function(t){console.log("response:",t),e.updateboard(t.GS)})},t.prototype.checkSafePlace=function(e){for(var t=0;t<8;t++)if(e==v.safePlace[t])return!0;return!1},t.prototype.updateboard=function(e){for(var t=0;t<4;t++)for(var o=0;o<4;o++){var n=4*t+o;g.chessplace[n]=parseInt(e.Pieces[t][o]);for(var c=this.checkSafePlace(g.chessplace[n]),r=!1,i=0;i<16;i++)-1!=g.chessplace[i]&&i!=n&&g.chessplace[i]==g.chessplace[n]&&(r=!0,.5!=g.chessplace[n].scale&&(Math.trunc(i/4)==t?(null==cc.find("player"+(t+1).toString()+"/"+(4*t+i%4).toString(),this.players)&&console.log("null"),this.canvas.changeMoveShape(t,o,parseInt(e.Pieces[t][o]),cc.find("player"+(t+1).toString()+"/"+n.toString(),this.players),cc.find("player"+(t+1).toString()+"/"+i.toString(),this.players))):c&&(null==cc.find("player"+Math.trunc(i/4+1).toString()+"/"+i.toString(),this.players)&&console.log("null"),this.canvas.changeMoveShape(t,o,parseInt(e.Pieces[t][o]),cc.find("player"+(t+1).toString()+"/"+n.toString(),this.players),cc.find("player"+Math.trunc(i/4+1).toString()+"/"+i.toString(),this.players)))));r?r=!1:this.canvas.move(t,o,parseInt(e.Pieces[t][o]),cc.find("player"+(t+1).toString()+"/"+(4*t+o).toString(),this.players))}0==(y=parseInt(e.Turn))?this.turncolor.color=cc.color(51,200,19):1==y?this.turncolor.color=cc.color(250,255,0):2==y?this.turncolor.color=cc.color(46,184,255):3==y&&(this.turncolor.color=cc.color(255,0,0)),d=e.DicePoint,f=0==e.Movable?"Throw":"Move",this.Dice.getComponent(cc.Button).enabled="Throw"==f,this.Status.string="Action:"+f},t.prototype.piecesenabled=function(){for(var e=this,t=0;t<4;t++)for(var o=0;o<4;o++)cc.find("player"+(t+1).toString()+"/"+(4*t+o).toString(),this.players).off(cc.Node.EventType.TOUCH_END,function(){e.Movetosever(o)})},t.prototype.switchmod=function(){"Board"==h?(h="Analysis",this.node.setPosition(0,1e3),this.Board.setPosition(0,1e3),this.Analysis.setPosition(0,0)):"Analysis"==h&&(h="Board",this.node.setPosition(0,0),this.Board.setPosition(-160,0),this.Analysis.setPosition(0,1e3))},r([u(cc.Node)],t.prototype,"players",void 0),r([u(a.default)],t.prototype,"canvas",void 0),r([u(cc.Node)],t.prototype,"turncolor",void 0),r([u(cc.Label)],t.prototype,"Status",void 0),r([u(cc.Node)],t.prototype,"Dice",void 0),r([u(cc.Node)],t.prototype,"ip",void 0),r([u(cc.Node)],t.prototype,"Analysis",void 0),r([u(cc.Node)],t.prototype,"Board",void 0),r([u(s.default)],t.prototype,"Analysisfunc",void 0),r([p],t)}(cc.Component);o.default=m,cc._RF.pop()},{"./Board":"Board","./WebSocket":"WebSocket","./analysis":"analysis"}],WebSocket:[function(e,t,o){"use strict";cc._RF.push(t,"648fbRLrvJDb4W5eu4B6FI8","WebSocket"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.connect=function(t){e.ws=new WebSocket(e.uri),e.ws.onopen=function(){console.log("connected to "+e.uri),e.isOpen=!0,e.callbackList=[],t()},e.ws.onclose=function(t){console.log("connection closed ("+t.code+")"),e.isOpen=!1,e.disconnect(t)},e.ws.onmessage=function(t){e.callbackList[0](JSON.parse(t.data)),e.callbackList.shift()}},e.send=function(t,o){e.isOpen&&(e.ws.send(t),e.callbackList.push(o))},e.isOpen=!1,e}();o.default=n,cc._RF.pop()},{}],analysis:[function(e,t,o){"use strict";cc._RF.push(t,"7d217W6DXBIm49p+D/TADPe","analysis");var n,c=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var c,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(c=e[a])&&(i=(r<3?c(i):r>3?c(t,o,i):c(t,o))||i);return r>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./WebSocket"),a=cc._decorator,s=a.ccclass,l=a.property,p=["","","",""],u=[],f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Testtimes=null,t.Data=null,t.ChooseAI=null,t.name0=null,t.name1=null,t.name2=null,t.name3=null,t.turn=null,t}return c(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.GetAItosever=function(){var e=this,t={Method:"GetAI",PlayerIndex:0,PieceIndex:0};console.log("request:",t),i.default.send(JSON.stringify(t),function(t){console.log("response:",t),u=t.AINames;for(var o=0;o<4;o++){p[o]=t.AINames[0],cc.find(o.toString()+"/name",e.ChooseAI).getComponent(cc.Label).string=t.AINames[0];for(var n=0;n<10;n++)cc.find(o.toString()+"/view/content/"+(10*o+n).toString(),e.ChooseAI).active=!1}for(o=0;o<4;o++)for(n=0;n<t.AINames.length;n++)cc.find(o.toString()+"/view/content/"+(10*o+n).toString(),e.ChooseAI).active=!0,cc.find(o.toString()+"/view/content/"+(10*o+n).toString(),e.ChooseAI).on("click",e.SetAI,e),cc.find(o.toString()+"/view/content/"+(10*o+n).toString()+"/Background/Label",e.ChooseAI).getComponent(cc.Label).string=t.AINames[n]})},t.prototype.SetAI=function(e){p[Math.floor(parseInt(e.name)/10)]=u[Math.floor(parseInt(e.name)%10)],0==Math.floor(parseInt(e.name)/10)?this.name0.string=u[Math.floor(parseInt(e.name)%10)]:1==Math.floor(parseInt(e.name)/10)?this.name1.string=u[Math.floor(parseInt(e.name)%10)]:2==Math.floor(parseInt(e.name)/10)?this.name2.string=u[Math.floor(parseInt(e.name)%10)]:3==Math.floor(parseInt(e.name)/10)&&(this.name3.string=u[Math.floor(parseInt(e.name)%10)])},t.prototype.SetAItosever=function(){var e={Method:"SetAI",PlayerIndex:0,PieceIndex:0,AINames:p};console.log("request:",e),i.default.send(JSON.stringify(e),function(e){console.log("response:",e)})},t.prototype.AItesttosever=function(){var e={Method:"AITest",PlayerIndex:0,PieceIndex:0,TestTimes:Number(this.Testtimes.string)};console.log("request:",e),i.default.send(JSON.stringify(e),function(e){console.log("response:",e)}),this.schedule(this.Showgameresult,0,0,1)},t.prototype.Showgameresult=function(){var e=this,t={Method:"GetGameResult",PlayerIndex:0,PieceIndex:0};console.log("request:",t),i.default.send(JSON.stringify(t),function(t){console.log("response:",t),e.updatedata(t.Result)})},t.prototype.updatedata=function(e){for(var t=0;t<4;t++)cc.find("Eatensum/Player"+t.toString()+"/Label",this.Data).getComponent(cc.Label).string=e.EatenSum[t],cc.find("Eatothersum/Player"+t.toString()+"/Label",this.Data).getComponent(cc.Label).string=e.EatOthersSum[t],cc.find("Gateopenedsum/Player"+t.toString()+"/Label",this.Data).getComponent(cc.Label).string=e.GateOpenedSum[t],0==parseInt(e.WinSum[t])?cc.find("Turnusedavg/Player"+t.toString()+"/Label",this.Data).getComponent(cc.Label).string="0":cc.find("Turnusedavg/Player"+t.toString()+"/Label",this.Data).getComponent(cc.Label).string=parseFloat((parseInt(e.TurnUsedSum[t])/parseInt(e.WinSum[t])).toFixed(2)).toString(),cc.find("Winsum/Player"+t.toString()+"/Label",this.Data).getComponent(cc.Label).string=e.WinSum[t],0==parseInt(e.GameCount)?cc.find("Winavg/Player"+t.toString()+"/Label",this.Data).getComponent(cc.Label).string="0":cc.find("Winavg/Player"+t.toString()+"/Label",this.Data).getComponent(cc.Label).string=parseFloat((parseInt(e.WinSum[t])/parseInt(e.GameCount)).toFixed(2)).toString();this.turn.string="Turn:"+e.GameCount},r([l(cc.EditBox)],t.prototype,"Testtimes",void 0),r([l(cc.Node)],t.prototype,"Data",void 0),r([l(cc.Node)],t.prototype,"ChooseAI",void 0),r([l(cc.Label)],t.prototype,"name0",void 0),r([l(cc.Label)],t.prototype,"name1",void 0),r([l(cc.Label)],t.prototype,"name2",void 0),r([l(cc.Label)],t.prototype,"name3",void 0),r([l(cc.Label)],t.prototype,"turn",void 0),r([s],t)}(cc.Component);o.default=f,cc._RF.pop()},{"./WebSocket":"WebSocket"}],player:[function(e,t,o){"use strict";cc._RF.push(t,"946f5XV/dNNZpV+Ds+xBbsy","player");var n,c=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var c,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(c=e[a])&&(i=(r<3?c(i):r>3?c(t,o,i):c(t,o))||i);return r>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Board"),a=e("./ClientTest"),s=cc._decorator,l=s.ccclass,p=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.race0=null,t.race1=null,t.race2=null,t.race3=null,t.canvas=null,t.clientTest=null,t.idx0=0,t.idx1=0,t.idx2=0,t.idx3=0,t.playerColor="",t}return c(t,e),t.prototype.onLoad=function(){var e=this;this.race0.on(cc.Node.EventType.TOUCH_END,function(){e.clientTest.Movetosever(0)}),this.race1.on(cc.Node.EventType.TOUCH_END,function(){e.clientTest.Movetosever(1)}),this.race2.on(cc.Node.EventType.TOUCH_END,function(){e.clientTest.Movetosever(2)}),this.race3.on(cc.Node.EventType.TOUCH_END,function(){e.clientTest.Movetosever(3)})},t.prototype.start=function(){},r([p(cc.Node)],t.prototype,"race0",void 0),r([p(cc.Node)],t.prototype,"race1",void 0),r([p(cc.Node)],t.prototype,"race2",void 0),r([p(cc.Node)],t.prototype,"race3",void 0),r([p(i.default)],t.prototype,"canvas",void 0),r([p(a.default)],t.prototype,"clientTest",void 0),r([p],t.prototype,"playerColor",void 0),r([l],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./Board":"Board","./ClientTest":"ClientTest"}]},{},["Board","ClientTest","WebSocket","analysis","player"]);